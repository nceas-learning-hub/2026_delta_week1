{
  "hash": "d95c28e7d859ba0ebb380c4ccf04af9b",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: Literate Analysis with Quarto\neditor: \n  markdown: \n    wrap: 72\n---\n\n\n\n\n::: callout-tip\n## Learning Objectives\n\nAfter completing this session, you will be able to:\n\n-   Describe the concept of literate analysis and how it supports\n    reproducible data science\n-   Format prose (non-code) text in a Quarto document using Markdown\n    syntax\n-   Incorporate functional code chunks into a Quarto document and\n    customize their output\n-   Build and render a complete example analysis\n:::\n\n## Introduction to Literate Programming\n\nTraditional code is written for computers - it can be hard for humans to\nfollow, even the person who wrote it. In 1984, computer science pioneer\nDonald Knuth proposed flipping this around: rather than instructing a\ncomputer, write code that *explains your thinking to other people*.\n\n> \"Instead of imagining that our main task is to instruct a computer\n> what to do, let us concentrate rather on explaining to human beings\n> what we want a computer to do.\" - Donald Knuth, 1984\n\nIn a **literate analysis**, we weave together natural-language prose\n(describing your goals, methods, and interpretations) with functional\ncode (that actually performs the analysis). The result renders into a\npolished HTML, PDF, or Word report - a single document that is both\nhuman-readable and fully reproducible.\n\n<!-- All too often, computational methods are written in such a way as to be borderline incomprehensible even to the person who originally wrote the code! The reason for this is obvious: computers interpret information very differently than people do. In 1984, Donald Knuth proposed a reversal of the programming paradigm by introducing the concept of *Literate Programming* ([Knuth 1984](http://www.literateprogramming.com/knuthweb.pdf)). -->\n\n<!-- > *\"Instead of imagining that our main task is to instruct a computer what to do, let us concentrate rather on explaining to human beings what we want a computer to do.\"* -->\n\n<!-- If our aim is to make scientific research more transparent, the appeal of this paradigm reversal is immediately apparent. By switching to a literate analysis model, **you help enable human understanding of what the computer is doing**. As Knuth describes, in the literate analysis model, the author is an \"*essayist*\" who chooses variable names carefully, explains what they mean, and introduces concepts in the analysis in a way that facilitates understanding. -->\n\n<!-- In practice, literate programming is achieved by interleaving sections of natural language prose that describe the goals, methods, and interpretation of an analysis, with sections of code that perform the analysis, generate figures, and save results.  The resulting document is usually rendered as a nicely-formatted report in HTML, MS Word, or PDF format.  Contrast this with a more traditional script, which includes only functional code with (hopefully) a few brief explanatory comments. -->\n\n## Quarto and Literate Programming\n\n**Quarto** is an open-source publishing system that makes literate\nanalysis straightforward. A Quarto file (`.qmd`) mixes formatted prose\nwith executable **code chunks**, and renders them together into a\ncomplete report.\n\n::: callout-tip\n### Coding languages in Quarto\n\nWe will focus on using Quarto with R code, but it is designed to work\nseamlessly with other coding languages as well, including Python, Julia,\nand Observable JavaScript. You can even use multiple languages in the\nsame document.\n:::\n\n::: callout-note\n### Quarto vs. RMarkdown\n\nIf you've used RMarkdown (`.Rmd`) before, Quarto (`.qmd`) will feel\nfamiliar. The main differences are that Quarto has richer multi-language\nsupport and improved formatting options. Both formats share the same\nthree-part structure: YAML, prose, and code chunks.\n:::\n\n### Why does this matter for reproducibility?\n\nWhen your entire analysis - data loading, cleaning, statistics, and\nfigures - lives in one Quarto document, you can re-run everything with a\nsingle click. If the data updates, so does your report. This eliminates\nerror-prone copy-pasting between scripts, spreadsheets, and documents,\nand gives collaborators (and your future self!) a clear trail from raw\ndata to final results.\n\n<!-- In an R script, the language assumes that you are writing R code, unless you specify that you are writing prose (using a comment, designated by `#`). The paradigm shift of literate analysis comes in the switch to RMarkdown or Quarto, where instead of assuming you are writing code, they assume that you are writing prose unless you specify that you are writing code. This, along with the formatting provided by markdown, encourages the \"essayist\" to write understandable prose to accompany the code that explains to the human-beings reading the document what the author told the computer to do. This is in contrast to writing just R code, where the author telling to the computer what to do with maybe a smattering of terse comments explaining the code to a reader. -->\n\n### Example: Literate Analysis From Quarto\n\nLet's look at an example of what a rendered literate analysis looks like\nusing a real example. [Here is an\nexample](https://nceas.github.io/sasap-training/materials/reproducible_research_in_r_fairbanks/example-brood-table-analysis.html)\nof an analysis workflow written using RMarkdown. Note that if this\nanalysis would be in Quarto, the render version it would be similar,\nexcept for formatting and layout (eg: the default font in Quarto is\ndifferent).\n\nThere are a few things to notice about this document, which assembles a\nset of similar data sources on salmon brood tables with different\nformatting into a single data source.\n\n-   It introduces the data sources using in-line images, links,\n    interactive tables, and interactive maps.\n-   An example of data formatting from one source using R is shown.\n-   The document executes a set of formatting scripts in a directory to\n    generate a single merged file.\n-   Some simple quality checks are performed (and their output shown) on\n    the merged data.\n-   Simple analysis and plots are shown.\n\nIn addition to achieving literate analysis, this document also\nrepresents a **reproducible analysis**. Because the entire merging and\nquality control of the data is done using the R code in the Quarto file,\nif a new data source and formatting script are added, the document can\nbe run all at once with a single click to re-generate the quality\ncontrol, plots, and analysis of the updated data.\n\n## Structure of a Quarto Document\n\nEvery Quarto document has three components:\n\n-   **YAML header** - metadata at the very top of the file, enclosed in\n    `---`. It controls the document title, author, output format, and a\n    lot more.\n    \n:::{.callout-tip appearance=\"simple\" icon=false}\n\n``` yaml\n---\ntitle: \"My Analysis\"\nauthor: \"Your Name\"\nformat: html\n---\n```\n:::\n\n-   **Prose** - plain text written in Markdown (the white areas of the\n    document).\n    \n:::{.callout-tip appearance=\"simple\" icon=false}\n:::\n\n-   **Code chunks** - executable code blocks (the grey areas), opened\n    with ```` ```{r} ```` and closed with ```` ``` ````.\n    \n:::{.callout-tip appearance=\"simple\" icon=false}\n\n```{{r}}\nx <- \"Hello world!\"\ny <- 1 + 1\n```\n\n<!--NOTE: the double curly braces mean this will *display* as an R code chunk including header and footer, but not execute -->\n:::\n\n## Let's Create A Quarto Document\n\n:::{.panel-tabset}\n\n#### RStudio\n\n1.  In RStudio, go to **File** {{< fa arrow-right >}} **New File**\n    {{< fa arrow-right >}} **Quarto Document**.\n2.  Give it a title (e.g., \"Introduction to Quarto\"), leave the other\n    options as-is, then click **Create**.\n3.  Look at what you get: a YAML header at the top, with title and format, and a blank canvas below.\n    \n#### Positron\n\n1.  In Positron, go to **File** {{< fa arrow-right >}} **New File**\n    {{< fa arrow-right >}} **Quarto Document**.\n2.  Look at what you get: a YAML header at the top for title and format, and a blank canvas below.\n3.  Fill in the title (e.g., \"Introduction to Quarto\")\n\n:::\n\nBelow the YAML header, let's add some content.  Type or copy/paste so your document looks like this:\n\n:::{.callout-note collapse=\"true\"}\n\n### Expand this block and add this code to your Quarto document\n\n```yaml\n---\ntitle: \"Untitled\"\nformat: html\n---\n```\n```\n## Quarto\n\n### Markdown section\nIn this section, include prose text formatted using Markdown syntax.\n\n### Code chunks\n\nYou can also include code chunks:\n```\n```{{r basic math}}\nx <- 1 + 1\nx\n```\n```\n## Including Plots\n\nYou can also embed plots, for example:\n```\n```{{r pressure plot}}\n#| echo: false\nplot(pressure)\n```\n:::\n\nClick the **Render** button. You will be asked to save first - give it a useful name (e.g., `quarto_test.qmd`) and save it in your `scripts/` folder.\n\nYou'll see an HTML file appear in your browser. Notice:\n\n-   The first code chunk (`1 + 1`) runs and displays its result.\n-   The second chunk shows the result but not the code - that's because\n    it includes the code chunk option `#| echo: false`. More on these\n    later!\n\n### YAML header\n\n???\n\n### Markdown Syntax\n\nThe prose sections of a Quarto document use **Markdown**, a lightweight\nformatting language with only \\~15 rules to learn. Markdown is also used\nin GitHub READMEs, Slack, and many other tools, so it's well worth\nknowing.\n\n| Syntax             | Result                 |\n|--------------------|------------------------|\n| `# Heading 1`      | Large top-level header |\n| `## Heading 2`     | Smaller sub-header     |\n| `**bold**`         | **bold**               |\n| `*italic*`         | *italic*               |\n| `[link text](url)` | Hyperlink              |\n| `* item`           | Bullet list            |\n| `1. item`          | Numbered list          |\n\nFor a full reference, see https://www.markdownguide.org/cheat-sheet/.\n\n::: callout-tip\nThe `#` symbol means something different in R code (a comment) vs.\nMarkdown (a header). In Markdown, the number of `#` symbols you use\nmatters: `#` is the biggest header, `###` up to `######` are\nconsecutively smaller and nested below it.\n:::\n\n::: callout-exercise\nAdd some italic text, a numbered list, and a sub-header to your\ndocument. Try a few other Markdown syntax options. Re-render and check\nthe output.\n:::\n\n### Visual vs. Source Editor\n\nQuarto includes a **Visual Editor** that lets you format text visually, like a\nword processor. While we recommend learning raw Markdown (**Source\nEditor**) - since you'll use it in many other contexts - the Visual\nEditor has two genuinely useful features:\n\n-   **Citations:** Go to **Insert \\> Citation**, choose a source (e.g.,\n    paste a DOI), and Quarto automatically formats the citation, creates\n    a `references.bib` file, and updates your YAML header. Done.\n-   **Tables:** Markdown tables are tedious to type by hand. Use the\n    **Table** menu to insert and edit them visually.\n\nTo toggle between Visual Editor and Source Editor mode:\n\n* RStudio: Click the \"Visual\" button (vs. \"Source\") at the top right of the editor pane.\n* Positron: Command-Shift-F4 (Mac) or Ctrl-Shift-F4 (Windows).\n\n::: callout-exercise\nEnable Visual Editor mode.\n\nAdd a citation (e.g., DOI 10.1038/s41467-020-17726-z) into a section of\nprose in your Quarto document, using the Visual Editor.\n\nAdd a table into your Quarto document using the Visual Editor.\n\nToggle back to Source Editor mode. Look at the raw Markdown and BibTeX that was generated for your citation and table.\n\nRender the document and check the differences in the output.\n:::\n\n### Code Chunks in Quarto\n\nCode chunks contain functional code to be executed.  Markdown syntax will not work here!  A code chunk \nYou can create a new chunk in your Quarto in one of these ways:\n\n-   Go to Code in the top menu bar, click \"Insert Chunk\"\n-   Use the keyboard shortcut\n    -   RStudio: Mac: Command-Option-i or  Windows: Ctrl-Alt-i\n    -   Positron: Mac: Command-Shift-i or  Windows: Ctrl-Shift-i\n-   Type by hand:\n\n```{{r}}\n```\n\n#### Executing Code Chunks in Interactive Mode\n\nAll the R code in your Quarto document will execute when you Render the document, but you can also run it on the fly (\"interactive\" mode) to test and debug it as you write.\n\n::: {.panel-tabset}\n##### RStudio\n\nMultiple options to run code; here are a few:\n\n1.  Select the line (or simply put the cursor there), and click \"Run\".\n    This is available from:\n    a.  the bar above the file (green arrow)\n    b.  the menu bar: Code \\> Run Selected Line(s)\n    c.  keyboard shortcut: Command-Enter or Ctrl-Enter\n2.  Click the green arrow at the right of the code chunk to run the entire chunk.\n\n##### Positron\n\nMultiple options to run code; here are a few:\n\n1.  Select the line (or simply put the cursor there), and use the keyboard shortcut: Command-Enter or Ctrl-Enter\n2.  Click the Run Cell arrow above the code chunk to run the entire chunk.\n\n:::\n\n:::{.callout-exercise}\nAdd a code chunk to your Quarto document:\n\n```{{r}}\nx <- 4 * 8\n\nhights_ft <- c(5.2, 6.0, 5.7)\n\ncoef <- 3.14\n```\n\nRun the code in interactive mode, and examine the values in the Environment pane (RStudio) or Session Variables pane (Positron).\n:::\n\n#### Code chunk options\n\nHere are some common options available to customize code chunk outputs.\n\n| Option              | What it does                                   |\n|---------------------|------------------------------------------------|\n| `#| eval: false`    | Don't run the code (just display it)           |\n| `#| echo: false`    | Run the code, but hide it from the output      |\n| `#| message: false` | Suppress diagnostic messages                   |\n| `#| warning: false` | Suppress warning messages                      |\n| `#| include: false` | Run the code silently - no output shown at all |\n| `#| fig-width: 6`   | Set the width (or height) of a plot (in inches)|\n| `#| fig-align: center` | Set the alignment of a plot (left, right, center) |\n\nOptions can be combined. For example, an exploratory chunk you don't\nwant in your final report:\n\n```{{r}}\n#| eval: false # <1>\n#| echo: false # <2>\nsummary(my_data)\n```\n1. Don't evaluate/run the code\n2. Don't show the code in the rendered output\n\nMany more code chunk options can be found at\n[Quarto.org](https://quarto.org/docs/computations/execution-options.html).\n\n## Practice: Literate Analysis with ocean water samples\n\nNow that we have gone over the basics, let's go a little deeper by\nbuilding a simple, Quarto document that represents a literate analysis\nusing real data. We are going to work with the seawater chemistry data.\nWe are going to use the `BGchem2008data.csv` data we downloaded in our\nprevious session.\n\n<!-- download a file named `BGchem2008data.csv` from the Arctic Data Center repository. Please follow the steps below to download the data and then upload to your RStudio Server `data` folder. -->\n\n### Getting Started\n\n<!-- ::: callout-tip -->\n\n<!-- #### Set up -->\n\n<!-- 1.  Navigate to this dataset by Craig Tweedie that is published on the Arctic Data Center. [Craig Tweedie. 2009. North Pole Environmental Observatory Bottle Chemistry. Arctic Data Center. doi:10.18739/A25T3FZ8X.](http://doi.org/10.18739/A25T3FZ8X) -->\n\n<!-- 2.  Download the first csv file called `BGchem2008data.csv` by clicking the \"download\" button next to the file. -->\n\n<!-- 3. Click the \"Upload\" button in your RStudio server file browser. -->\n\n<!-- 3. In the dialog box, make sure the destination directory is the `data` directory in your R project, click \"Choose File,\" and locate the `BGchem2008data.csv` file. Press \"OK\" to upload the file. -->\n\n<!-- 4. Check your file was successfully uploaded by navigating into your `data` folder in the **Files** pane. -->\n\n<!-- ::: -->\n\nExperienced R users who have never used Quarto (or RMarkdown) often\nstruggle a bit in the transition to developing analysis in Prose+Code\nformat --- which makes sense! It is switching the code paradigm to a new\nway of thinking.\n\nRather than starting an R chunk and putting all of your code in that\nsingle chunk, below we describe what we think is a better way.\n\n1.  Open a document and block out the high-level sections you know\n    you'll need to include using top level headers.\n2.  Add bullet points for some high level pseudo-code steps you know\n    you'll need to take.\n3.  Start filling in under each bullet point the code that accomplishes\n    each step. As you write your code, transform your bullet points into\n    prose, and add new bullet points or sections as needed.\n\nFor this mini-analysis, we will have the following sections and code\nsteps:\n\n1.  Introduction\n    a.  About the data\n    b.  Setup\n    c.  Read in data\n2.  Analysis\n    a.  Calculate summary statistics\n    b.  Calculate mean Redfield ratio\n    c.  Plot Redfield ratio\n3.  Conclusion\n\n::: callout-note\n## Exercise\n\nUnder \"About the data\", write a sentence saying where the data set came\nfrom, including a hyperlink ti the data. Also mention when was the data\ndownloaded.\n\nHint: Navigate to Help \\> Markdown Quick Reference to look-up the\nhyperlink syntax.\n:::\n\n### Read in the data\n\nNow that we have outlined our document, we can start writing code! To\nread the data into our environment, we will use a function from the\n`readr` package.\n\nTo use a package in our analysis, we need to first make sure it is\ninstalled (you can install a package by running\n`install.package(\"name-of-package\")`). Once installed you need to load\nit into our environment using `library(package_name)`. Even though we\nhave installed it, we haven't yet told our R session to access it.\nBecause there are so many packages (many with conflicting namespaces) R\ncannot automatically load every single package you have installed.\nInstead, you load only the ones you need for a particular analysis.\n**Loading the package is a key part of the *reproducible* aspect of our\nliterate analysis**, so we will include it as an R chunk as part of our\nSetup.\n\n::: {.callout-caution icon=\"false\"}\n## Best Practice\n\nIt is generally good practice to include all of your `library()` calls\nin a single, dedicated R chunk near the top of your document. This lets\ncollaborators know what packages they might need to install before they\nstart running your code.\n:::\n\nThe server should have already installed the two packages we need for\nnow: `readr` and `here`. Let's add a new R chunk below your Setup header\nthat calls these libraries, and run it.\n\nIt should look like this:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(readr)\nlibrary(here)\n```\n:::\n\n\n\n\n::: {.callout-caution icon=\"false\"}\n## Quarto file path and the `here()` function\n\nQuarto has a special way of handling relative paths that can be very\nhandy. When working in an Quarto document, **R will set all paths\nrelative to the location of the Quarto file**. This can make things\neasier to read in data if your Quarto document is stored in the same\ndirectory or \"near\" by. However, more often that not, your `.qmd` file\nwill be stored in a a folder (e.g `scripts`) and your data in a `data`\nfolder, (both folder in the main project directory).\n\nThe `here()` function helps navigate this file path mix up in a straight\nforward and reproducible way. This function sets the file path to the\nproject's directory and builds the rest of the file path from there.\nMaking it easier to find files inside different folders in a project. In\nthis case, because the `.qmd` file lives in the script folder, `here()`\nmakes is easy to navigate back into the project's directory and then\ninto the `data` folder to read in our file.\n:::\n\nNow, under \"Read data\", add a code chunk that uses the `read_csv()` with\nthe `here()` function to read in your data file.\n\n\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stderr}\n\n```\nRows: 70 Columns: 19\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr   (1): Station\ndbl  (16): Latitude, Longitude, Target_Depth, CTD_Depth, CTD_Salinity, CTD_T...\ndttm  (1): Time\ndate  (1): Date\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nbg_chem <- read_csv(here::here(\"data/BGchem2008data.csv\"))\n```\n:::\n\n\n\n\n::: column-margin\n**Why `read_csv()` over `read.csv()`?**\n\nWe chose to show `read_csv()` from the `readr` package to introduce the\nconcept of packages, to show you how to load packages, and `read_csv()`\nhas several advantages over `read.csv()` from base R, including:\n\n-   More reasonable function defaults (no `stringsAsFactors`!)\n-   Smarter column type parsing, especially for dates\n-   `read_csv()` is much faster than `read.csv()`, which is helpful for\n    large files\n:::\n\nOnce you run this line in your document, you should see the `bg_chem`\nobject populate in your environment pane. It also spits out lots of text\nexplaining what types the function parsed each column into. This text is\nimportant, and should be examined, but we might not want it in our final\ndocument.\n\n::: callout-note\n## Exercise\n\nHow would you suppress the warnings (so they don't show in our output\nfile) form a specific code chunk?\n\n**Hint:** Code chunk options\n:::\n\n### Calculate Summary Statistics\n\nAs our \"analysis\" we are going to calculate some very simple summary\nstatistics and generate a single plot. Using water samples from the\nArctic Ocean, we will examine the ratio of nitrogen to phosphate to see\nhow closely the data match the Redfield ratio, which is the consistent\n16:1 ratio of nitrogen to phosphorous atoms found in marine\nphytoplankton.\n\nLet's start by exploring the data we just read. Every time we read a new\ndata set, it is important to familiarize yourself with it and make sure\nthat the data looks as expected. Below some useful functions for\nexploring your data.\n\nLet's start by creating a new R chunk and run the following functions.\nBecause this just an exploration and we do not want this chunk to be\npart of our report, we will indicate that by adding `#|eval: false` and\n`#| echo: false` in the setup of the chunk, that way, the code in this\nchunk will not run and not be displayed when I knit the final document.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Prints the column names of my data frame\ncolnames(bg_chem)\n\n## General structure of the data frame - shows class of each column\nstr(bg_chem)\n\n## First 6 lines of the data frame\nhead(bg_chem)\n\n## Summary of each column of data\nsummary(bg_chem)\n\n## Prints unique values in a column (in this case Date)\nunique(bg_chem$Date)\n```\n:::\n\n\n\n\nTo peek out data frame, we can type `View(bg_chem)` in the console. This\nwill open a tab with our data frame in a tabular format.\n\nNow that we know a more about the data set we are working with lets do\nsome analyses. Under the appropriate bullet point in your analysis\nsection, create a new R chunk, and use it to calculate the mean nitrate\n(NO3), nitrite (NO2), ammonium (NH4), and phosphorous (P) measured.\n\nSave these mean values as new variables with easily understandable\nnames, and write a (brief) description of your operation using markdown\nabove the chunk. Remember that the `$` (aka the subset operator)\nindicates which column of your data to look into.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnitrate <- mean(bg_chem$NO3)\nnitrite <- mean(bg_chem$NO2)\namm <- mean(bg_chem$NH4)\nphos <- mean(bg_chem$P)\n```\n:::\n\n\n\n\nIn another chunk, use those variables to calculate the nitrogen:\nphosphate ratio (Redfield ratio).\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nratio <- (nitrate + nitrite + amm)/phos\n```\n:::\n\n\n\n\nYou can access this variable in your markdown text by using R in-line in\nyour text. The syntax to call R in-line (as opposed to as a chunk) is a\nsingle back tick \\`, followed by the letter \"r\", then whatever your\nsimple R command is --- here we will use `round(ratio)` to print the\ncalculated ratio, and finally a closing back tick \\`. This allows us to\naccess the value stored in this variable in our explanatory text without\nresorting to the evaluate-copy-paste method so commonly used for this\ntype of task.\n\nSo, the text in you Quarto document should look like this:\n\nThe Redfield ratio for this dataset is approximately: \\`r\n`round(ratio)`\\`\n\nAnd the rendered text like this:\n\nThe Redfield ratio for this dataset is approximately 6.\n\nFinally, create a simple plot using base R that plots the ratio of the\nindividual measurements, as opposed to looking at mean ratio.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(bg_chem$P, bg_chem$NO2 + bg_chem$NO3 + bg_chem$NH4)\n```\n\n::: {.cell-output-display}\n![](s09_r_quarto_literate_analysis_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n\n\n::: callout-note\n## Exercise\n\nDecide whether or not you want the plotting code above to show up in\nyour knitted document along with the plot, and implement your decision\nas a chunk option.\n\nRender your Quarto document (by pressing the Render button) and observe\nthe results.\n:::\n\n::: callout-important\n## How do I decide when to make a new code chunk?\n\nLike many of life's great questions, there is no clear cut answer. A\nrule of thumb is to have one chunk per functional unit of analysis. This\nfunctional unit could be 50 lines of code or it could be 1 line, but\ntypically it only does one \"thing.\" This could be reading in data,\nmaking a plot, or defining a function. It could also mean calculating a\nseries of related summary statistics (as we'll see below). Ultimately,\nthe choice is one related to personal preference and style, but\ngenerally you should ensure that code is divided up such that it is\neasily explainable in a literate analysis as the code is run.\n:::\n\n## Quarto and Environments\n\nLet's walk through an exercise with the document we just created to\ndemonstrate how Quarto handles environments. We will be deliberately\ninducing some errors here for demonstration purposes.\n\nFirst, follow these steps:\n\n::: callout-tip\n## Setup\n\n-   Restart your R session (Session \\> Restart R)\n-   Run the last chunk in your Quarto document by pressing the play\n    button on the chunk\n:::\n\nPerhaps not surprisingly, we get an error:\n\n```         \nError in plot(bg_chem$P, bg_chem$NO2 + bg_chem$NO3 + bg_chem$NH4) : \n  object 'bg_chem' not found\n```\n\nThis is because we have not run the chunk of code that reads in the\n`bg_chem` data. The R part of Quarto works just like a regular R script.\nYou have to execute the code, and the order that you run it in matters.\nIt is relatively easy to get mixed up in a large Quarto document ---\nrunning chunks out of order, or forgetting to run chunks.\n\nTo resolve this, follow the next step:\n\n::: callout-tip\n## Setup continued\n\n-   Select from the \"Run\" menu (top right of the editor pane) \"Run All.\"\n-   Observe the `bg_chem` variable in your environment\n:::\n\nThis is a great way to reset and re-run code when things seem to have\ngone sideways. It is great practice to do periodically since it helps\nensure you are writing code that actually runs and it's reproducible.\n\n::: callout-tip\n## For the next exercise:\n\n-   Clean your environment by clicking the broom in the environment pane\n-   Restart your R session (Session \\> Restart R)\n-   Press \"Render\" to run all of the code in your document\n-   Observe the state of your environment pane\n\nAssuming your document rendered and produced an html page, your code\nran. Yet, the environment pane is empty. What happened?\n:::\n\nThe Render button is rather special --- it doesn't just run all of the\ncode in your document. It actually spins up a fresh R environment\nseparate from the one you have been working in, runs all of the code in\nyour document, generates the output, and then closes the environment.\nThis is one of the best ways Quarto (or RMarkdown) helps ensure you have\nbuilt a reproducible workflow. If, while you were developing your code,\nyou ran a line in the console as opposed to adding it to your Quarto\ndocument, the code you develop while working actively in your\nenvironment will still work. However, when you knit your document, the\nenvironment RStudio spins up doesn't know anything about that working\nenvironment you were in. Thus, your code may error because it doesn't\nhave that extra piece of information. Commonly, `library()` calls are\nthe source of this kind of frustration when the author runs it in the\nconsole, but forgets to add it to the script.\n\nTo further clarify the point on environments, perform the following\nsteps:\n\n::: callout-tip\n## Setup continued\n\n-   Select from the \"Run\" menu (top right of editor pane) \"Run All\"\n-   Observe all of the variables in your environment\n:::\n\n::: callout-important\n## What about all my R Scripts?\n\nSome pieces of R code are better suited for R scripts than Quarto or\nRMarkdown. A function you wrote yourself that you use in many different\nanalyses is probably better to define in an R script than repeated\nacross many Quarto or RMarkdown documents. Some analyses have mundane or\nrepetitive tasks that don't need to be explained very much. For example,\nin the document shown in the beginning of this lesson, 15 different\nexcel files needed to be reformatted in slightly different, mundane\nways, like renaming columns and removing header text. Instead of\nincluding these tasks in the primary Quarto document, the authors chose\nto write one R script per file and stored them all in a directory. Then,\ntook the contents of one script and included it in the literate\nanalysis, using it as an example to explain what the scripts did, and\nthen used the `source()` function to run them all from within the Quarto\ndocument.\n\nSo, just because you know Quarto now, doesn't mean you won't be using R\nscripts anymore. Both `.R` and `.qmd` have their roles to play in\nanalysis. With practice, it will become more clear what works well in\nQuarto or RMarkdown, and what belongs in a regular R script.\n:::\n\n## Additional Quarto Resources\n\n-   Posit (the organization that developed Quarto) has great\n    documentation, check out [Quarto.org](https://quarto.org/)\n-   R for Data Science (2e) (Wickham et al, 2023), this is an awesome\n    book for all R related things. Chapter [29 and\n    30](https://r4ds.hadley.nz/quarto.html) are specific to Quarto.\n-   [Quarto Gallery:](https://quarto.org/docs/gallery/) Example of\n    different outputs created using Quarto\n-   [Hello Quarto: share, collaborate, teach,\n    reimagine](https://openscapes.org/blog/2022-08-10-quarto-keynote/).\n    A talk by Julia Stewart Lowndes and Mine Cetinkaya-Runde.\n\n## Troubleshooting: My RMarkdown/Quarto doc Won't Knit to PDF\n\nIf you get an error when trying to knit to PDF that says your computer\ndoesn't have a LaTeX installation, one of two things is likely\nhappening:\n\n-   Your computer doesn't have LaTeX installed\n-   You have an installation of LaTeX but RStudio cannot find it (it is\n    not on the path)\n\nIf you already use LaTeX (like to write papers), you fall in the second\ncategory. Solving this requires directing RStudio to your installation -\nand isn't covered here.\n\nIf you fall in the first category - you are sure you don't have LaTeX\ninstalled - can use the R package `tinytex` to easily get an\ninstallation recognized by RStudio, as long as you have administrative\nrights to your computer.\n\nTo install `tinytex` run:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ninstall.packages(\"tinytex\")\ntinytex::install_tinytex()\n```\n:::\n\n\n\n\nIf you get an error that looks like destination /usr/local/bin not\nwritable, you need to give yourself permission to write to this\ndirectory (again, only possible if you have administrative rights). To\ndo this, run this command in the terminal:\n\n``` bash\nsudo chown -R `whoami`:admin /usr/local/bin\n```\n\nand then try the above install instructions again. Learn more about\n`tinytex` from [Yihui Xie's online book\n*TinyTeX*](https://yihui.org/tinytex/). \\`\\`\\`\\`\n",
    "supporting": [
      "s09_r_quarto_literate_analysis_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}