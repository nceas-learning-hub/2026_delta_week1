---
title: Git and GitHub Setup
---

:::{.callout-tip}
## Learning objectives

After completing this session, you will be able to:

- Recognize how to set Git defaults for your local computer
- Create a <u>p</u>ersonal <u>a</u>ccess <u>t</u>oken (PAT)
- Paraphrase how to tell Git how to reconcile differences between branches
:::

## Set Git's Global Options

Before using Git, you need to tell it who you are, also known as setting the **global options**. You can do this either with command line code or with the R package `usethis`. For this lesson we will use the `usethis` package. However, you can also find the command line code to reference in the future.

::: {.callout-note}
## What's the Terminal?

Technically, the "Terminal" is an interface for the shell, a computer program. To put that simply, we use the Terminal to tell a computer what to do. This is different from the "Console" in Positron, which interprets R code and returns a value.

The Terminal should be visible by default in Positron, but if it is not, you can open it by clicking "Terminal" {{< fa arrow-right >}} "New Terminal"

A Terminal tab should now be open right next to the Console tab.
:::

::: {.callout-tip}
## Don't Fear the Terminal!

Most of our Git operations will be done with R code, but there are some situations where you _must_ work in the Terminal and use command line. It may be daunting to code in the Terminal, but as your comfort increases over time, you might find you prefer it. Either way, it's beneficial to learn _enough_ command line and to not be intimidated in the Terminal. 

:::

To introduce ourselves to git we are going to update our global options with our GitHub user name and email information. We'll use the R code tab below but check out the terminal tab if doing this via command line is of interest.

::: {.callout-important}
## Case and Spelling Matter!

When you add your username and email to the global options <u>you **must** use the exact same spelling and casing that you used on GitHub</u>, otherwise Git won't be able to sync to your account.
:::

::: {.panel-tabset}
#### Console {{< fa brands r-project >}}

**Step 1:** Tell Git (1) your GitHub username, (2) your GitHub-associated email address, and (3) how you want Git to reconcile differences between your local work and a GitHub repository.

```{r}
#| eval: false
usethis::use_git_config(user.name = "my_user_name", # <1>
                        user.email = "my_email@nceas.ucsb.edu") # <2>
```

1. Add you exact same GitHub user name. Case and spelling matters!
2. Set up your email address associated to you GitHub account.

**Step 2:** Define the default name for a branch that gets created when you make the first commit in a new Git repository (a.k.a. "repo").

```{r}
#| eval: false
usethis::git_default_branch_configure(name = "main")
```

**Step 3:** Check to make sure everything looks correct.

```{r}
#| eval: false
usethis::git_sitrep()
```

#### Terminal {{< fa terminal >}}

**Step 1:** Tell Git your GitHub username. Note that <u>if the code runs successfully, it will look like nothing happened</u>. We will check at the end to make sure it worked.

```bash
git config --global user.name "my_user_name"
```

**Step 2:** Tell Git your GitHub-associated email address.

```bash
git config --global user.email "my_email@nceas.ucsb.edu"
```

**Step 3:** Define the default name for a branch that gets created when you make the first commit in a new Git repository (a.k.a. "repo").

``` bash
git config --global init.defaultBranch main
```

**Step 4:** Check to make sure everything looks correct. The following command return the global options you have set.

``` bash
git config --global --list
```

:::

::: {.callout-note}
## Why Change the Default Branch Name?

Previously, the default branch name was "master" and this terminology for Git branches is problematic, which motivates us to update our default branch to "main" instead. 

:::

## GitHub Authentication

While you will use your GitHub password to log in to your account on a web browser, in order to actually send code you write from your local computer up to GitHub, you'll need to "authenticate" in a different, more secure way.

The book [Happy Git and GitHub for the useR](https://happygitwithr.com/index.html) has a wealth of information related to working with Git in R, and the instructions below are based off of [Chapter 9: Personal access token for HTTPS](https://happygitwithr.com/https-pat.html) in that book.

We will be using a **Personal Access Token (PAT)** in this course. For better security and long term use, we recommend taking the extra steps to set up SSH keys (check out [Chapter 10 Set up Keys for SSH](https://happygitwithr.com/ssh-keys.html)).

::: {.callout-tip}
## Setting up Your PAT

1. Run `usethis::create_github_token()` in the Console.
2. A new browser window should open up to GitHub, showing all the "scopes" options. You can review the scopes, but you don't need to worry about which ones to select this time. The previous function automatically pre-selects some recommended scopes. **Go ahead and scroll to the bottom and click "Generate Token"**.
3. <u>Copy the generated token.</u> You will not be able to see this token again (ever) when you leave this page!
4. Back in the Console of Positron, run `gitcreds::gitcreds_set()`.
5. Paste your PAT when the prompt asks for it.
6. Run `usethis::git_sitrep()` in the Console to check your Git configuration and that you've successful stored your PAT. 
**Note:** look for `Personal access token for 'https://github.com': '<discovered>'`

If you see `<unset>` instead of `<discovered>` means your PAT is not correctly set. You'll need to troubleshoot.

:::

Congrats! Now you've setup your authentication you should be able to work with GitHub in Positron now.

## Strategy for Integrating Changes Across Branches

There is one more piece of setup to which we need to attend before we can move on. When you're working on the same GitHub repository as the rest of your team, what happens when you and a teammate edit the same file at the same time? How does Git 'know' how to reconcile those differences? Simply put, we tell Git how we want it to make that judgement call!

There are three options, "merge," "rebase," and "fast forward." **We recommend that you choose the "merge" strategy** as it will seamlessly handle easy situations where human oversight isn't needed but will flag more nuanced problems (called "merge conflicts") for you to resolve manually. For more information on "merge" versus "rebase", see [here](https://www.atlassian.com/git/tutorials/merging-vs-rebasing), but for the moment, trust us about the merge strategy. Note that you could always revisit this decision later using essentially the same code we provide below!

It is important to highlight too that this configuration can be repository specific. This means you can configure how you want Git to reconcile two branches at a repository level instead of doing so for all repositories in which you work. This allows you to control how Git weaves things in when collaborating with others in a project-specific fashion.

::: {.panel-tabset}
#### Console {{< fa brands r-project >}}

Set the default strategy for reconciling differences.

```{r}
#| eval: false
usethis::use_git_config(pull.rebase = "false")
```

#### Terminal {{< fa terminal >}}

Set the default strategy for reconciling differences.

```bash
git config --global pull.rebase false
```

:::

If you don't define a merge stratgy globally, you will have to define it for each repository that you create. If you have differences between branches and try to sync your local computer with the GitHub repository, you will likely get the following error message. Note that the error message itself gives you the terminal code that you'd need to fix it!

```
hint: You have divergent branches and need to specify how to reconcile them.
hint: You can do so by running one of the following commands sometime before
hint: your next pull:
hint: 
hint:    git config pull.rebase false # merge (the default strategy)
hint:    git config pull.rebase true  # rebase
hint:    git config pull.ff only      # fast-forward only
hint: 
hint: You can replace "git config" with "git config --global" to set a default
hint: preference for all repositories. You can also pass --rebase, --norebase, 
hint: or --ff-only on the command line to override the configured default per
hint: invocation.
fatal: Need to specify how to reconcile divergent branches
```

